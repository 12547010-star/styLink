<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>styLink - あなたの作るあの子のスタイル</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.7.1.js"
        integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
    <style>
        /* グローバルスタイル */
        body {
            font-family: sans-serif;
            margin: 0;
            padding: 0;
            background-color: #fce4ec; /* 淡いピンクの背景 */
            overflow-x: hidden;
        }

        /* ページ切り替えのスタイル */
        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        /* メインコンテナのスタイル（常時表示） */
        .main-container {
            margin-left: 250px;
        }

        /* メニューバーのスタイル */
        .side-menu {
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            width: 220px;
            background-color: #fff;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
            z-index: 200;
        }

        .logo {
            padding: 20px;
            text-align: center;
        }

        .logo img {
            width: 180px;
        }

        .user-profile {
            padding: 15px 20px;
            text-align: center;
            border-bottom: 1px solid #eee;
        }

        .profile-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            margin-bottom: 5px;
        }

        .profile-name {
            margin: 0;
            font-weight: bold;
            font-size: 0.9em;
        }

        .menu-items {
            padding-top: 10px;
        }

        .menu-item {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            text-decoration: none;
            color: #555;
            transition: background-color 0.2s;
        }

        .menu-item:hover {
            background-color: #f8bbd0; /* ホバーで少し濃いピンク */
            color: #fff;
        }
        .menu-item.active { /* アクティブなメニュー項目のスタイル */
            background-color: #f48fb1; /* メニューがアクティブな色 */
            color: #fff;
            font-weight: bold;
        }
        .menu-item.active .material-icons {
            color: #fff;
        }

        .menu-item .material-icons {
            margin-right: 15px;
        }

        /* 新しいホーム画面のスタイル */
        .page-title {
            padding: 16px;
            background-color: #fff;
            border-bottom: 1px solid #ddd;
            margin: 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .user-info,
        .favorite-items {
            padding: 16px;
            background-color: #fff;
            border-bottom: 1px solid #ddd;
            margin-bottom: 10px;
        }

        /* プロフィール編集画面のスタイル */
        .profile-edit-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            padding: 15px;
        }

        .profile-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .profile-item label {
            flex-basis: 120px;
            font-weight: bold;
        }

        .input-field {
            flex-grow: 1;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        .center-align {
            flex-direction: column;
            align-items: center;
        }

        .profile-icon {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
            cursor: pointer;
        }

        .username-edit-wrapper {
            display: flex;
            align-items: center;
            gap: 5px;
            justify-content: center;
        }

        .username-input {
            text-align: center;
            font-size: 1.2em;
            font-weight: bold;
            border: none;
            background: none;
            pointer-events: none;
        }

        .edit-icon {
            cursor: pointer;
            color: #999;
        }

        .file-input {
            display: none;
        }

        .image-upload-btn {
            flex-grow: 1;
            padding: 10px;
            border: 1px solid #ccc;
            background-color: #eee;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 5px;
        }

        /* ON/OFFトグルスイッチのスタイルとテキストの配置 */
        .toggle-and-label {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 40px;
            height: 20px;
        }

        .toggle-switch .toggle-input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-switch .toggle-label {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 20px;
        }

        .toggle-switch .toggle-label:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 2px;
            bottom: 2px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        .toggle-input:checked+.toggle-label {
            background-color: #f48fb1; /* ピンクのトグル */
        }

        .toggle-input:checked+.toggle-label:before {
            transform: translateX(20px);
        }

        .toggle-text {
            font-size: 14px;
            color: #666;
        }

        /* ヘッダーのスタイル調整（サーチ画面用） */
        .app-header {
            background-color: #fff;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            padding: 10px 16px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .search-bar-container {
            position: relative;
            display: flex;
            align-items: center;
            background-color: #eee;
            border-radius: 20px;
            padding: 5px 15px;
            width: 100%;
        }

        .search-bar {
            width: 100%;
            border: none;
            background: transparent;
            padding: 8px 0;
            font-size: 16px;
        }

        .search-bar:focus {
            outline: none;
        }

        .search-icon,
        .clear-icon {
            position: absolute;
            color: #999;
            font-size: 18px;
        }

        .search-icon {
            left: 15px;
        }

        .clear-icon {
            right: 15px;
            display: none;
        }

        .main-content {
            padding: 0 16px;
        }

        .item-grid-container {
            padding-bottom: 70px;
        }

        .item-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            padding: 10px 0;
        }

        .item-card {
            background-color: #fff;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            position: relative;
            height: 200px;
        }

        .item-image {
            width: 100%;
            height: 140px;
            object-fit: cover;
            background-color: #ffe4e1;
        }

        .item-details {
            padding: 5px;
        }

        .item-name {
            font-size: 10px;
            font-weight: bold;
            margin: 0;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .item-price {
            font-size: 10px;
            font-weight: bold;
            color: #333;
            margin: 2px 0 0;
        }

        .favorite-icon {
            position: absolute;
            top: 5px;
            right: 5px;
            color: #fff;
            font-size: 16px;
            text-shadow: 0 0 2px rgba(0, 0, 0, 0.5);
            z-index: 10;
        }

        .favorite-icon.favorited {
            color: #f48fb1; /* お気に入りマークをピンクに */
        }

        .filter-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #f48fb1; /* ピンクのフィルターボタン */
            color: #fff;
            padding: 15px 25px;
            border-radius: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
            z-index: 50;
        }

        .send-to-friend-btn {
            position: absolute;
            bottom: 5px;
            right: 5px;
            background-color: #f48fb1; /* ピンクのボタン */
            color: #fff;
            padding: 4px 8px;
            border-radius: 10px;
            font-size: 8px;
            cursor: pointer;
            z-index: 10;
            font-weight: bold;
            letter-spacing: 0.5px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: background-color 0.2s ease;
        }

        .send-to-friend-btn:hover {
            background-color: #f8bbd0; /* ホバーで少し淡いピンク */
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
            transition: opacity 0.3s ease;
        }

        .modal-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .modal-content {
            background-color: #fff;
            padding: 20px;
            border-radius: 10px;
            width: 90%;
            max-width: 400px;
            position: relative;
            transform: translateY(20px);
            transition: transform 0.3s ease;
        }

        .modal-overlay:not(.hidden) .modal-content {
            transform: translateY(0);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
            margin-bottom: 15px;
        }

        .modal-close {
            cursor: pointer;
            color: #999;
        }

        .friend-list-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .friend-item {
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            transition: background-color 0.2s;
            padding: 8px;
            border-radius: 5px;
        }

        .friend-item:hover {
            background-color: #f0f0f0;
        }

        .friend-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: #ddd;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 14px;
            color: #fff;
        }

        .friend-name {
            font-weight: bold;
        }

        /* タイムラインのスタイル */
        .post-button,
        .add-event-button {
            background-color: #f48fb1; /* ピンクのボタン */
            color: #fff;
            border: none;
            border-radius: 20px;
            padding: 8px 15px;
            display: flex;
            align-items: center;
            gap: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.2s;
        }

        .post-button:hover,
        .add-event-button:hover {
            background-color: #f8bbd0; /* ホバーで少し淡いピンク */
        }

        .timeline-tabs {
            display: flex;
            justify-content: center;
            align-items: center;
            border-bottom: 1px solid #ddd;
            background-color: #fff;
        }

        .timeline-tab {
            padding: 15px 20px;
            cursor: pointer;
            font-weight: bold;
            color: #999;
            position: relative;
        }

        .timeline-tab.active {
            color: #f48fb1; /* アクティブなタブをピンクに */
        }

        .timeline-tab.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 100%;
            height: 2px;
            background-color: #f48fb1; /* アクティブなタブの下線をピンクに */
        }

        #timeline-container {
            padding: 20px;
        }

        .post-card {
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            overflow: hidden;
        }

        .post-header {
            display: flex;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #eee;
        }

        .post-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            margin-right: 10px;
        }

        .post-user-info {
            flex-grow: 1;
        }

        .post-username {
            font-weight: bold;
            margin: 0;
        }

        .post-id {
            color: #999;
            font-size: 0.9em;
        }

        .post-body img {
            max-width: 100%;
            height: auto;
            display: block;
        }

        .post-actions {
            display: flex;
            justify-content: space-around;
            padding: 10px;
            border-top: 1px solid #eee;
        }

        .post-actions .material-icons {
            font-size: 20px;
            color: #555;
            cursor: pointer;
            transition: color 0.2s;
        }

        .post-actions .material-icons:hover {
            color: #f48fb1; /* ピンクのホバーエフェクト */
        }

        /* 投稿用モーダルウィンドウのスタイル */
        .post-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        #post-caption {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            resize: vertical;
            font-size: 14px;
        }

        .image-upload-label {
            background-color: #f0f0f0;
            color: #555;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-weight: bold;
            transition: background-color 0.2s;
        }

        .image-upload-label:hover {
            background-color: #e0e0e0;
        }

        /* プレビュー画像のコンテナ */
        .post-preview-container {
            display: flex;
            gap: 10px;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
        }

        /* プレビュー画像のスタイル */
        .preview-image {
            width: 80px;
            height: 120px;
            object-fit: cover;
            border-radius: 5px;
            border: 1px solid #ddd;
            cursor: pointer;
        }

        .submit-post-button {
            background-color: #f48fb1; /* ピンクの投稿ボタン */
            color: #fff;
            border: none;
            border-radius: 5px;
            padding: 12px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .submit-post-button:hover {
            background-color: #f8bbd0; /* ホバーで少し淡いピンク */
        }

        /* 投稿カード内の画像コンテナ */
        .post-image-container {
            display: flex;
            gap: 5px;
            padding: 10px;
        }

        .post-image-container img {
            width: calc(33.33% - 5px);
            height: 250px;
            object-fit: cover;
            border-radius: 5px;
            cursor: pointer;
        }

        /* 画像拡大モーダル用スタイル */
        .image-modal-content {
            background: transparent;
            padding: 0;
            max-width: 90%;
            max-height: 90%;
            overflow: hidden;
        }

        #modal-image {
            width: 100%;
            height: auto;
            max-height: 90vh;
            object-fit: contain;
        }

        /* シェアクローゼットのスタイル */
        .shared-items-container {
            display: none;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            padding: 20px;
        }

        .shared-items-container.active {
            display: grid;
        }

        .shared-item-card {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            transition: transform 0.2s;
        }

        .shared-item-card:hover {
            transform: translateY(-5px);
        }

        .shared-item-header {
            padding: 15px;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .shared-item-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
        }

        .shared-item-info {
            flex-grow: 1;
        }

        .shared-from-name {
            font-weight: bold;
            margin: 0;
        }

        .shared-date {
            font-size: 0.8em;
            color: #999;
        }

        .shared-item-image {
            width: 100%;
            height: 250px;
            object-fit: cover;
            display: block;
        }

        .shared-item-details {
            padding: 15px;
        }

        .shared-item-name {
            font-weight: bold;
            margin: 0;
        }

        .shared-item-price {
            color: #555;
            margin-top: 5px;
        }

        .share-closet-tabs {
            display: flex;
            justify-content: center;
            align-items: center;
            border-bottom: 1px solid #ddd;
            background-color: #fff;
        }

        .share-closet-tab {
            padding: 15px 20px;
            cursor: pointer;
            font-weight: bold;
            color: #999;
            position: relative;
        }

        .share-closet-tab.active {
            color: #f48fb1; /* アクティブなタブをピンクに */
        }

        .share-closet-tab.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 100%;
            height: 2px;
            background-color: #f48fb1; /* アクティブなタブの下線をピンクに */
        }

        /* 試着機能のスタイル */
        .try-on-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        .mannequin-container {
            position: relative;
            width: 300px;
            height: 500px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .mannequin-image {
            position: absolute;
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .try-on-item-image {
            position: absolute;
            width: 100%;
            height: auto;
            object-fit: contain;
        }

        .tops-layer {
            z-index: 3;
            top: 50px;
        }

        .bottoms-layer {
            z-index: 2;
            top: 250px;
        }

        .shoes-layer {
            z-index: 1;
            top: 400px;
        }

        .try-on-controls {
            width: 100%;
            max-width: 600px;
            margin-top: 20px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            padding: 10px;
        }

        .try-on-tabs {
            display: flex;
            justify-content: space-around;
            border-bottom: 1px solid #ddd;
        }

        .try-on-tab {
            padding: 10px 20px;
            cursor: pointer;
            font-weight: bold;
            color: #999;
            position: relative;
        }

        .try-on-tab.active {
            color: #f48fb1; /* アクティブなタブをピンクに */
        }

        .try-on-tab.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 100%;
            height: 2px;
            background-color: #f48fb1; /* アクティブなタブの下線をピンクに */
        }

        .item-selection-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            padding: 10px;
            margin-top: 10px;
        }

        .try-on-thumbnail {
            width: 100%;
            height: 120px;
            object-fit: cover;
            border-radius: 5px;
            cursor: pointer;
            border: 2px solid transparent;
            transition: border-color 0.2s;
        }

        .try-on-thumbnail:hover {
            border-color: #f48fb1; /* ホバーでピンクの枠線 */
        }

        /* リアルイベントのスタイル */
        .event-content {
            display: flex;
            gap: 20px;
            padding: 20px;
        }

        .calendar-container {
            flex: 1;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            padding: 20px;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .calendar-header .material-icons {
            cursor: pointer;
        }

        #current-month-year {
            font-size: 1.2em;
            font-weight: bold;
        }

        .calendar-days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            text-align: center;
            font-weight: bold;
            color: #555;
            border-bottom: 1px solid #ddd;
            padding-bottom: 10px;
        }

        .calendar-dates {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
            margin-top: 10px;
        }

        .day {
            padding: 10px;
            text-align: center;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.2s;
            position: relative;
        }

        .day:hover {
            background-color: #f0f0f0;
        }

        .day.active {
            background-color: #f48fb1; /* アクティブな日付をピンクに */
            color: #fff;
            font-weight: bold;
        }

        .day.empty {
            background-color: #f8f8f8;
            cursor: default;
        }

        .event-dot {
            position: absolute;
            bottom: 5px;
            left: 50%;
            transform: translateX(-50%);
            width: 5px;
            height: 5px;
            background-color: #f48fb1; /* イベントドットをピンクに */
            border-radius: 50%;
        }

        .event-list-container {
            flex: 1;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            padding: 20px;
        }

        #event-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        #event-list li {
            background-color: #fce4ec; /* イベントリストの背景を淡いピンクに */
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 10px;
            border-left: 3px solid #f48fb1; /* ボーダーをピンクに */
        }

        .event-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .save-event-button {
            background-color: #f48fb1; /* ピンクの保存ボタン */
            color: #fff;
            border: none;
            border-radius: 5px;
            padding: 12px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .save-event-button:hover {
            background-color: #f8bbd0; /* ホバーで少し淡いピンク */
        }

        /* 新規追加スタイル */

        /* ユーザー切り替えコンテナのスタイル */
        .user-switch {
            padding: 10px 20px;
            border-top: 1px solid #eee;
        }

        /* ユーザー選択ドロップダウンのスタイル */
        #user-selector {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: #f9f9f9;
            font-size: 14px;
            cursor: pointer;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="#666"><polygon points="0,0 10,0 5,10"/></svg>');
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 8px;
        }

        /* タイムラインの投稿画像が複数枚ある場合のコンテナスタイル */
        .post-image-container.multiple {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 5px;
        }

        /* タイムラインの投稿画像が複数枚ある場合の個別画像スタイル */
        .timeline-post-image.multiple {
            width: 100%;
            height: 120px;
            object-fit: cover;
            border-radius: 5px;
        }

        /* 友だちリストのアイテムスタイル */
        .friend-list-container {
            padding: 0;
        }

        .friend-item {
            display: flex;
            align-items: center;
            padding: 10px 15px;
            gap: 15px;
            border-radius: 8px;
            transition: background-color 0.2s;
        }

        .friend-item:hover {
            background-color: #f5f5f5;
        }

        .friend-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
        }

        /* 768px以下の画面幅 (タブレット・モバイル) */
        @media (max-width: 768px) {
            .main-container {
                margin-left: 0;
                padding-top: 60px;
            }

            .side-menu {
                width: 100%;
                height: 60px;
                bottom: 0;
                top: auto;
                display: flex;
                justify-content: space-around;
                align-items: center;
                box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.1);
                border-top: 1px solid #ddd;
            }

            .side-menu .logo,
            .side-menu .user-profile {
                display: none;
            }

            .menu-items {
                padding-top: 0;
                display: flex;
                width: 100%;
                justify-content: space-around;
            }

            .menu-item {
                flex-direction: column;
                align-items: center;
                font-size: 10px;
                padding: 8px;
            }

            .menu-item .material-icons {
                margin-right: 0;
                margin-bottom: 2px;
            }

            .item-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .try-on-container {
                flex-direction: column;
            }

            .mannequin-container {
                width: 100%;
                height: 400px;
            }

            .item-selection-grid {
                grid-template-columns: repeat(3, 1fr);
            }

            .event-content {
                flex-direction: column;
            }
        }
    </style>
</head>

<body>

    <div id="side-menu" class="side-menu">
        <div class="logo">
            <img src="img/logo.png" alt="styLink logo">
        </div>
        <div class="user-profile">
            <img src="img/avatar_placeholder.png" alt="ユーザーアバター" class="profile-avatar">
            <p class="profile-name">ユーザー名</p>
        </div>
        <div class="user-switch">
            <select id="user-selector">
                <option value="山田">山田</option>
                <option value="田中">田中</option>
                <option value="佐藤">佐藤</option>
                <option value="鈴木">鈴木</option>
                <option value="高橋">高橋</option>
                <option value="渡辺">渡辺</option>
                <option value="伊藤">伊藤</option>
                <option value="中村">中村</option>
            </select>
        </div>
        <nav class="menu-items">
            <a href="#" class="menu-item active" data-page="home"><span class="material-icons">home</span> ホーム</a>
            <a href="#" class="menu-item" data-page="search"><span class="material-icons">search</span> サーチ</a>
            <a href="#" class="menu-item" data-page="timeline"><span class="material-icons">local_fire_department</span> みんなのオススメ</a>
            <a href="#" class="menu-item" data-page="try-on"><span class="material-icons">checkroom</span> 試着</a>
            <a href="#" class="menu-item" data-page="favorites"><span class="material-icons">favorite_border</span> お気に入り</a>
            <a href="#" class="menu-item" data-page="share-closet"><span class="material-icons">folder_shared</span> シェアクローゼット</a>
            <a href="#" class="menu-item" data-page="event"><span class="material-icons">event</span> イベント日程</a>
            <a href="#" class="menu-item" data-page="settings"><span class="material-icons">settings</span> 設定</a>
        </nav>
    </div>

    <div id="main-container" class="main-container">
        <div id="home-page" class="page active">
            <h2 class="page-title">ホーム</h2>
            <div class="user-info">
                <h3>あなたの情報</h3>
                <div class="profile-edit-container">
                    <div class="profile-item center-align">
                        <label for="icon-upload" class="icon-label">
                            <img src="img/avatar_placeholder.png" alt="アイコン" id="current-icon" class="profile-icon">
                            <input type="file" id="icon-upload" accept="image/*" class="file-input">
                        </label>
                        <div class="username-edit-wrapper">
                            <input type="text" id="username-input" class="username-input" placeholder="ユーザー名" value="ユーザー名" readonly>
                            <span class="edit-icon material-icons">edit</span>
                        </div>
                    </div>
                    <div class="profile-item">
                        <label for="height-input">身長</label>
                        <input type="number" id="height-input" class="input-field" placeholder="例：170">
                        <div class="toggle-and-label">
                            <div class="toggle-switch">
                                <input type="checkbox" id="height-public-toggle" class="toggle-input">
                                <label for="height-public-toggle" class="toggle-label"></label>
                            </div>
                            <span class="toggle-text">公開する</span>
                        </div>
                    </div>
                    <div class="profile-item">
                        <label for="tops-size-select">トップスのサイズ</label>
                        <select id="tops-size-select" class="input-field">
                            <option value="">選択してください</option>
                            <option value="S">S</option>
                            <option value="M">M</option>
                            <option value="L">L</option>
                            <option value="XL">XL</option>
                        </select>
                        <div class="toggle-and-label">
                            <div class="toggle-switch">
                                <input type="checkbox" id="tops-public-toggle" class="toggle-input">
                                <label for="tops-public-toggle" class="toggle-label"></label>
                            </div>
                            <span class="toggle-text">公開する</span>
                        </div>
                    </div>
                    <div class="profile-item">
                        <label for="bottoms-size-select">ボトムスのサイズ</label>
                        <select id="bottoms-size-select" class="input-field">
                            <option value="">選択してください</option>
                            <option value="S">S</option>
                            <option value="M">M</option>
                            <option value="L">L</option>
                            <option value="XL">XL</option>
                        </select>
                        <div class="toggle-and-label">
                            <div class="toggle-switch">
                                <input type="checkbox" id="bottoms-public-toggle" class="toggle-input">
                                <label for="bottoms-public-toggle" class="toggle-label"></label>
                            </div>
                            <span class="toggle-text">公開する</span>
                        </div>
                    </div>
                    <div class="profile-item">
                        <label>顔写真</label>
                        <button class="image-upload-btn">
                            <span class="material-icons">camera_alt</span>
                        </button>
                        <div class="toggle-and-label">
                            <div class="toggle-switch">
                                <input type="checkbox" id="face-public-toggle" class="toggle-input">
                                <label for="face-public-toggle" class="toggle-label"></label>
                            </div>
                            <span class="toggle-text">公開する</span>
                        </div>
                    </div>
                    <div class="profile-item">
                        <label>ボディ写真</label>
                        <button class="image-upload-btn">
                            <span class="material-icons">camera_alt</span>
                        </button>
                        <div class="toggle-and-label">
                            <div class="toggle-switch">
                                <input type="checkbox" id="body-public-toggle" class="toggle-input">
                                <label for="body-public-toggle" class="toggle-label"></label>
                            </div>
                            <span class="toggle-text">公開する</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="favorite-items">
                <h3>あなたのお気に入り</h3>
                <div id="favorites-grid" class="item-grid">
                </div>
            </div>
        </div>

        <div id="search-page" class="page hidden">
            <header class="app-header">
                <div class="search-bar-container">
                    <input type="text" id="search-bar" class="search-bar" placeholder="         アイテムを検索">
                    <span class="search-icon material-icons">search</span>
                    <span class="clear-icon material-icons">close</span>
                </div>
            </header>
            <div class="main-content">
                <div class="item-grid-container">
                    <div id="item-grid" class="item-grid">
                    </div>
                </div>
            </div>
            <div class="filter-button">
                <span class="material-icons">filter_list</span>
                絞り込み
            </div>
        </div>

        <div id="timeline-page" class="page hidden">
            <h2 class="page-title">
                みんなのオススメを見る
                <button id="post-button" class="post-button">
                    <span class="material-icons">edit</span> 投稿
                </button>
            </h2>
            <div class="timeline-tabs">
                <div class="timeline-tab active" data-tab="recommended">おすすめ</div>
                <div class="timeline-tab" data-tab="following">フォロー中</div>
            </div>
            <div id="timeline-container">
            </div>
        </div>

        <div id="try-on-page" class="page hidden">
            <h2 class="page-title">試着</h2>
            <div class="try-on-container">
                <div class="mannequin-container">
                    <img src="img/mannequin.png" alt="マネキン" class="mannequin-image">
                    <img id="try-on-tops" class="try-on-item-image tops-layer" src="" alt="トップス">
                    <img id="try-on-bottoms" class="try-on-item-image bottoms-layer" src="" alt="ボトムス">
                    <img id="try-on-shoes" class="try-on-item-image shoes-layer" src="" alt="シューズ">
                </div>
                <div class="try-on-controls">
                    <div class="try-on-tabs">
                        <div class="try-on-tab active" data-category="tops">トップス</div>
                        <div class="try-on-tab" data-category="bottoms">ボトムス</div>
                        <div class="try-on-tab" data-category="shoes">シューズ</div>
                    </div>
                    <div class="item-selection-grid">
                    </div>
                </div>
            </div>
        </div>

        <div id="favorites-page" class="page hidden">
            <h2 class="page-title">お気に入り</h2>
            <div id="all-favorites-grid" class="item-grid">
            </div>
        </div>

        <div id="share-closet-page" class="page hidden">
            <h2 class="page-title">シェアクローゼット</h2>
            <div class="share-closet-tabs">
                <div class="share-closet-tab active" data-tab="shared-with">シェアされたアイテム</div>
                <div class="share-closet-tab" data-tab="shared-by">シェアしたアイテム</div>
            </div>
            <div id="shared-with-container" class="shared-items-container active">
            </div>
            <div id="shared-by-container" class="shared-items-container hidden">
            </div>
        </div>

        <div id="event-page" class="page hidden">
            <h2 class="page-title">
                リアルイベント
                <button id="add-event-button" class="add-event-button">
                    <span class="material-icons">add</span> 予定を追加
                </button>
            </h2>
            <div class="event-content">
                <div class="calendar-container">
                    <div class="calendar-header">
                        <span id="prev-month" class="material-icons">chevron_left</span>
                        <h3 id="current-month-year"></h3>
                        <span id="next-month" class="material-icons">chevron_right</span>
                    </div>
                    <div class="calendar-days">
                        <span>日</span>
                        <span>月</span>
                        <span>火</span>
                        <span>水</span>
                        <span>木</span>
                        <span>金</span>
                        <span>土</span>
                    </div>
                    <div id="calendar-dates" class="calendar-dates">
                    </div>
                </div>
                <div class="event-list-container">
                    <h3>今日の予定</h3>
                    <ul id="event-list">
                    </ul>
                </div>
            </div>
        </div>

        <div id="settings-page" class="page hidden">
            <h2 class="page-title">設定</h2>
            <p>ここに設定情報が表示されます。</p>
        </div>

        <div id="friend-modal" class="modal-overlay hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>誰に送りますか？</h3>
                    <span class="modal-close material-icons">close</span>
                </div>
                <div id="friend-list" class="friend-list-container">
                </div>
            </div>
        </div>

        <div id="post-modal" class="modal-overlay hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>新しい投稿</h3>
                    <span id="post-modal-close" class="modal-close material-icons">close</span>
                </div>
                <div class="post-form">
                    <textarea id="post-caption" placeholder="キャプションを入力..." rows="4"></textarea>
                    <label for="post-image-upload" class="image-upload-label">
                        <span class="material-icons">add_photo_alternate</span> 写真を選択
                        <input type="file" id="post-image-upload" accept="image/*" class="file-input" multiple>
                    </label>
                    <div id="post-preview-container" class="post-preview-container"></div>
                    <button id="submit-post-button" class="submit-post-button">投稿する</button>
                </div>
            </div>
        </div>

        <div id="event-modal" class="modal-overlay hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>予定を追加</h3>
                    <span id="event-modal-close" class="modal-close material-icons">close</span>
                </div>
                <div class="event-form">
                    <label for="event-title-input">タイトル</label>
                    <input type="text" id="event-title-input" class="input-field" placeholder="予定のタイトル">

                    <label for="event-date-input">日付</label>
                    <input type="date" id="event-date-input" class="input-field">

                    <label for="event-time-input">時間</label>
                    <input type="time" id="event-time-input" class="input-field">

                    <button id="save-event-button" class="save-event-button">保存</button>
                </div>
            </div>
        </div>

        <div id="image-modal" class="modal-overlay hidden">
            <div class="modal-content image-modal-content">
                <span id="image-modal-close" class="modal-close material-icons">close</span>
                <img id="modal-image" src="" alt="拡大画像">
            </div>
        </div>

    </div>


    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const itemGrid = document.getElementById('item-grid');
            const searchBar = document.getElementById('search-bar');
            const friendModal = document.getElementById('friend-modal');
            const modalCloseBtn = document.querySelector('.modal-close');
            const friendListContainer = document.getElementById('friend-list');

            // 新しい画面切り替え用の要素
            const menuItems = document.querySelectorAll('.menu-item');
            const pages = document.querySelectorAll('.page');
            const favoritesGrid = document.getElementById('favorites-grid');
            const allFavoritesGrid = document.getElementById('all-favorites-grid');

            // ホーム画面の新しい要素
            const iconUpload = document.getElementById('icon-upload');
            const currentIcon = document.getElementById('current-icon');
            const usernameInput = document.getElementById('username-input');
            const editIcon = document.querySelector('.edit-icon');
            const profileName = document.querySelector('.profile-name');
            const profileAvatar = document.querySelector('.profile-avatar');
            
            // ユーザー切り替え
            const userSelector = document.getElementById('user-selector');


            // タイムライン画面の要素
            const timelineContainer = document.getElementById('timeline-container');
            const timelineTabs = document.querySelectorAll('.timeline-tab');
            const postButton = document.getElementById('post-button');
            const postModal = document.getElementById('post-modal');
            const postModalClose = document.getElementById('post-modal-close');
            const postCaptionInput = document.getElementById('post-caption');
            const postImageUpload = document.getElementById('post-image-upload');
            const postPreviewContainer = document.getElementById('post-preview-container');
            const submitPostButton = document.getElementById('submit-post-button');

            // シェアクローゼットの要素
            const sharedWithContainer = document.getElementById('shared-with-container');
            const sharedByContainer = document.getElementById('shared-by-container');
            const shareClosetTabs = document.querySelectorAll('.share-closet-tab');

            // 画像拡大モーダルの要素
            const imageModal = document.getElementById('image-modal');
            const imageModalClose = document.getElementById('image-modal-close');
            const modalImage = document.getElementById('modal-image');

            // 試着機能の要素
            const tryOnTabs = document.querySelectorAll('.try-on-tab');
            const itemSelectionGrid = document.querySelector('.item-selection-grid');
            const tryOnTops = document.getElementById('try-on-tops');
            const tryOnBottoms = document.getElementById('try-on-bottoms');
            const tryOnShoes = document.getElementById('try-on-shoes');

            // リアルイベント機能の要素
            const calendarDates = document.getElementById('calendar-dates');
            const currentMonthYear = document.getElementById('current-month-year');
            const prevMonthBtn = document.getElementById('prev-month');
            const nextMonthBtn = document.getElementById('next-month');
            const addEventButton = document.getElementById('add-event-button');
            const eventModal = document.getElementById('event-modal');
            const eventModalClose = document.getElementById('event-modal-close');
            const eventTitleInput = document.getElementById('event-title-input');
            const eventDateInput = document.getElementById('event-date-input');
            const eventTimeInput = document.getElementById('event-time-input');
            const saveEventButton = document.getElementById('save-event-button');
            const eventList = document.getElementById('event-list');

            let currentMonth = new Date().getMonth();
            let currentYear = new Date().getFullYear();
            let selectedDate = new Date(); // 今日の日付を初期値に

            // 8人分のダミーユーザーデータ
            const dummyUsers = [
                { name: '山田', userId: '@yamada', avatar: 'img/avatar_placeholder.png', isCurrentUser: true },
                { name: '田中', userId: '@tanaka', avatar: 'img/avatar_placeholder.png' },
                { name: '佐藤', userId: '@sato', avatar: 'img/avatar_placeholder.png' },
                { name: '鈴木', userId: '@suzuki', avatar: 'img/avatar_placeholder.png' },
                { name: '高橋', userId: '@takahashi', avatar: 'img/avatar_placeholder.png' },
                { name: '渡辺', userId: '@watanabe', avatar: 'img/avatar_placeholder.png' },
                { name: '伊藤', userId: '@ito', avatar: 'img/avatar_placeholder.png' },
                { name: '中村', userId: '@nakamura', avatar: 'img/avatar_placeholder.png' },
            ];

            // 友人リストのダミーデータを更新（8人中、自分以外の7人を友人とする）
            const dummyFriends = dummyUsers.filter(user => !user.isCurrentUser);

            // ダミーのイベントデータ（実際にはバックエンドから取得）
            let events = {
                '2025-09-25': [{ title: 'ファッションショー', time: '18:00', host: '佐藤' }],
                '2025-09-28': [{ title: 'フリマアプリ勉強会', time: '14:30', host: '田中' }],
            };
            
            // 全アイテムデータの配列
            const allDummyItems = [
                { name: 'Tシャツ', price: '¥11,000', imageUrl: 'img/item1.png', id: 'item1', category: 'tops' },
                { name: 'スウェット', price: '¥13,200', imageUrl: 'img/item1.png', id: 'item2', category: 'tops' },
                { name: 'Tシャツ/カットソー', price: '¥11,000', imageUrl: 'img/item1.png', id: 'item3', category: 'tops' },
                { name: 'フーディー', price: '¥9,800', imageUrl: 'img/item1.png', id: 'item4', category: 'tops' },
                { name: 'ジャケット', price: '¥15,000', imageUrl: 'img/item1.png', id: 'item5', category: 'tops' },
                { name: 'ブルゾン', price: '¥12,500', imageUrl: 'img/item1.png', id: 'item6', category: 'tops' },
                { name: 'Tシャツ', price: '¥11,000', imageUrl: 'img/item1.png', id: 'item7', category: 'tops' },
                { name: 'スウェット', price: '¥13,200', imageUrl: 'img/item1.png', id: 'item8', category: 'bottoms' },
                { name: 'Tシャツ/カットソー', price: '¥11,000', imageUrl: 'img/item1.png', id: 'item9', category: 'bottoms' },
                { name: 'フーディー', price: '¥9,800', imageUrl: 'img/item1.png', id: 'item10', category: 'shoes' },
                { name: 'ジャケット', price: '¥15,000', imageUrl: 'img/item1.png', id: 'item11', category: 'shoes' },
                { name: 'ブルゾン', price: '¥12,500', imageUrl: 'img/item1.png', id: 'item12', category: 'shoes' },
                { name: 'Tシャツ', price: '¥11,000', imageUrl: 'img/item1.png', id: 'item13', category: 'shoes' },
                { name: 'スウェット', price: '¥13,200', imageUrl: 'img/item1.png', id: 'item14', category: 'tops' },
                { name: 'Tシャツ/カットソー', price: '¥11,000', imageUrl: 'img/item1.png', id: 'item15', category: 'bottoms' },
            ];

            let favoriteItems = [];
            let sharedWithItems = [ // ダミーの「シェアされた」アイテム
                { name: 'フーディー', price: '¥9,800', imageUrl: 'img/item1.png', id: 'item4', sharerName: '山田', sharerAvatar: 'img/avatar_placeholder.png', date: '2025/9/19' },
                { name: 'ジャケット', price: '¥15,000', imageUrl: 'img/item1.png', id: 'item5', sharerName: '田中', sharerAvatar: 'img/avatar_placeholder.png', date: '2025/9/18' }
            ];
            let sharedByItems = []; // 「シェアした」アイテム

            // ダミーの投稿データ
            let dummyPosts = [
                { user: '田中', userId: '@tanaka', images: ['img/item1.png'], caption: '今日のコーデです！古着のスウェットがお気に入り。', likes: 125, comments: 5 },
                { user: '鈴木', userId: '@suzuki', images: ['img/item1.png', 'img/item1.png'], caption: '最近買ったジャケット、めちゃくちゃ形がいい。', likes: 88, comments: 2 },
                { user: '佐藤', userId: '@sato', images: ['img/item1.png', 'img/item1.png', 'img/item1.png'], caption: 'このスニーカー、どんな服に合わせようか迷うなぁ。', likes: 201, comments: 10 },
                { user: '高橋', userId: '@takahashi', images: ['img/item1.png'], caption: '新しいフーディー、これからの季節に大活躍しそう！', likes: 55, comments: 3 },
                { user: '渡辺', userId: '@watanabe', images: ['img/item1.png'], caption: 'ジャケットスタイルに挑戦！どうかな？', likes: 72, comments: 8 }
            ];

            // ユーザー切り替え処理
            function switchUser(userName) {
                const user = dummyUsers.find(u => u.name === userName);
                if (user) {
                    profileName.textContent = user.name;
                    profileAvatar.src = user.avatar;
                    usernameInput.value = user.name;
                    currentIcon.src = user.avatar;

                    // ここでは表示上の変更のみ
                    // favoriteItems や sharedByItems のデータは本来ユーザーごとに切り替える
                }
            }

            function renderItems(items, gridElement, isFavoritePage = false) {
                gridElement.innerHTML = '';
                items.forEach(item => {
                    const itemCard = document.createElement('div');
                    itemCard.className = 'item-card';

                    const isFavorited = favoriteItems.some(fav => fav.id === item.id);
                    const favIconClass = isFavorited ? 'favorite' : 'favorite_border';
                    const favIconColorClass = isFavorited ? 'favorited' : '';

                    itemCard.innerHTML = `
                        <img src="${item.imageUrl}" alt="${item.name}" class="item-image">
                        <div class="item-details">
                            <p class="item-name">${item.name}</p>
                            <p class="item-price">${item.price}</p>
                        </div>
                        <span class="favorite-icon material-icons ${favIconColorClass}" data-item-id="${item.id}">${favIconClass}</span>
                        ${isFavoritePage ? '' : '<div class="send-to-friend-btn">styLink!</div>'}
                    `;
                    gridElement.appendChild(itemCard);

                    const sendBtn = itemCard.querySelector('.send-to-friend-btn');
                    if (sendBtn) {
                        sendBtn.addEventListener('click', () => {
                            friendModal.classList.remove('hidden');
                            // どのアイテムが選択されたかをモーダルに渡す
                            friendModal.dataset.selectedItemId = item.id;
                        });
                    }

                    const favIcon = itemCard.querySelector('.favorite-icon');
                    favIcon.addEventListener('click', () => {
                        toggleFavorite(item);
                    });
                });
            }

            // 試着機能用のアイテムをレンダリングする関数
            function renderTryOnItems(category) {
                itemSelectionGrid.innerHTML = '';
                const itemsToDisplay = allDummyItems.filter(item => item.category === category);

                itemsToDisplay.forEach(item => {
                    const thumbnail = document.createElement('img');
                    thumbnail.src = item.imageUrl;
                    thumbnail.alt = item.name;
                    thumbnail.className = 'try-on-thumbnail';
                    thumbnail.dataset.imageUrl = item.imageUrl;

                    thumbnail.addEventListener('click', () => {
                        switch (category) {
                            case 'tops':
                                tryOnTops.src = item.imageUrl;
                                break;
                            case 'bottoms':
                                tryOnBottoms.src = item.imageUrl;
                                break;
                            case 'shoes':
                                tryOnShoes.src = item.imageUrl;
                                break;
                        }
                    });

                    itemSelectionGrid.appendChild(thumbnail);
                });
            }

            // カレンダーをレンダリングする関数
            function renderCalendar(month, year) {
                calendarDates.innerHTML = '';
                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);
                const startingDay = firstDay.getDay();

                currentMonthYear.textContent = `${year}年 ${month + 1}月`;

                // 前月の日付
                for (let i = 0; i < startingDay; i++) {
                    const dayCell = document.createElement('div');
                    dayCell.className = 'day empty';
                    calendarDates.appendChild(dayCell);
                }

                // 今月の日付
                for (let i = 1; i <= lastDay.getDate(); i++) {
                    const dayCell = document.createElement('div');
                    dayCell.className = 'day';
                    dayCell.textContent = i;

                    const dateString = `${year}-${String(month + 1).padStart(2, '0')}-${String(i).padStart(2, '0')}`;
                    dayCell.dataset.date = dateString;

                    // 今日の日付にactiveクラスを追加
                    const today = new Date();
                    if (i === today.getDate() && month === today.getMonth() && year === today.getFullYear()) {
                        dayCell.classList.add('active');
                    }

                    // イベントがある日にドットを表示
                    if (events[dateString] && events[dateString].length > 0) {
                        const eventDot = document.createElement('span');
                        eventDot.className = 'event-dot';
                        dayCell.appendChild(eventDot);
                    }

                    dayCell.addEventListener('click', (e) => {
                        document.querySelectorAll('.day').forEach(d => d.classList.remove('active'));
                        e.currentTarget.classList.add('active');
                        selectedDate = new Date(year, month, i);
                        renderEvents(dateString);
                    });
                    calendarDates.appendChild(dayCell);
                }
            }

            // イベントリストをレンダリングする関数
            function renderEvents(dateString) {
                eventList.innerHTML = '';
                const todaysEvents = events[dateString] || [];

                if (todaysEvents.length === 0) {
                    const li = document.createElement('li');
                    li.textContent = '予定はありません。';
                    li.className = 'no-events';
                    eventList.appendChild(li);
                } else {
                    todaysEvents.forEach(event => {
                        const li = document.createElement('li');
                        li.innerHTML = `<strong>${event.title}</strong><br><small>${event.time}</small>`;
                        eventList.appendChild(li);
                    });
                }
            }

            function renderTimeline(posts) {
                timelineContainer.innerHTML = '';
                posts.forEach(post => {
                    const postCard = document.createElement('div');
                    postCard.className = 'post-card';

                    // 投稿画像のHTMLを生成
                    const imageHtml = post.images.length > 0
                        ? `<div class="post-image-container ${post.images.length > 1 ? 'multiple' : ''}">
                                ${post.images.map(img => `<img src="${img}" alt="投稿画像" class="timeline-post-image ${post.images.length > 1 ? 'multiple' : ''}">`).join('')}
                           </div>`
                        : '';

                    postCard.innerHTML = `
                        <div class="post-header">
                            <img src="${dummyUsers.find(u => u.name === post.user)?.avatar}" alt="${post.user}のアバター" class="post-avatar">
                            <div class="post-user-info">
                                <p class="post-username">${post.user}</p>
                                <p class="post-id">${post.userId}</p>
                            </div>
                        </div>
                        <div class="post-body">
                            <p>${post.caption}</p>
                            ${imageHtml}
                        </div>
                        <div class="post-actions">
                            <div class="action-item"><span class="material-icons">favorite_border</span> ${post.likes}</div>
                            <div class="action-item"><span class="material-icons">chat_bubble_outline</span> ${post.comments}</div>
                            <div class="action-item"><span class="material-icons">share</span></div>
                        </div>
                    `;
                    timelineContainer.prepend(postCard); // 新しい投稿を一番上に表示

                    // 画像クリックで拡大表示
                    const postImages = postCard.querySelectorAll('.timeline-post-image');
                    postImages.forEach(img => {
                        img.addEventListener('click', (e) => {
                            modalImage.src = e.target.src;
                            imageModal.classList.remove('hidden');
                        });
                    });
                });
            }

            // 新しい関数: シェアされたアイテムをレンダリング
            function renderSharedItems(items, container, isSharedBy = false) {
                container.innerHTML = '';
                if (items.length === 0) {
                    const message = isSharedBy ? 'まだアイテムをシェアしていません。' : 'まだシェアされたアイテムはありません。';
                    container.innerHTML = `<p style="text-align: center; margin-top: 50px; color: #777;">${message}</p>`;
                } else {
                    items.forEach(item => {
                        const sharedCard = document.createElement('div');
                        sharedCard.className = 'shared-item-card';

                        const headerText = isSharedBy
                            ? `<span>${item.sharerName}さんにシェアしました</span>`
                            : `<span>${item.sharerName}さんからシェアされました</span>`;

                        sharedCard.innerHTML = `
                            <div class="shared-item-header">
                                <img src="${item.sharerAvatar}" alt="${item.sharerName}のアバター" class="shared-item-avatar">
                                <div class="shared-item-info">
                                    <p class="shared-from-name">${headerText}</p>
                                    <p class="shared-date">${item.date}</p>
                                </div>
                            </div>
                            <img src="${item.imageUrl}" alt="${item.name}" class="shared-item-image">
                            <div class="shared-item-details">
                                <p class="shared-item-name">${item.name}</p>
                                <p class="shared-item-price">${item.price}</p>
                            </div>
                        `;
                        container.appendChild(sharedCard);
                    });
                }
            }


            function toggleFavorite(item) {
                const index = favoriteItems.findIndex(fav => fav.id === item.id);
                if (index > -1) {
                    favoriteItems.splice(index, 1);
                } else {
                    favoriteItems.push(item);
                }
                updateFavorites();
            }

            function updateFavorites() {
                const homeFavs = favoriteItems.slice(0, 4);
                renderItems(homeFavs, favoritesGrid);
                renderItems(favoriteItems, allFavoritesGrid, true);
                renderItems(allDummyItems, itemGrid);
            }

            updateFavorites();
            renderItems(allDummyItems, itemGrid);

            if (searchBar) {
                searchBar.addEventListener('input', () => {
                    const query = searchBar.value.toLowerCase();
                    const filteredItems = allDummyItems.filter(item =>
                        item.name.toLowerCase().includes(query)
                    );
                    renderItems(filteredItems, itemGrid);
                });
            }

            dummyFriends.forEach(friend => {
                const friendItem = document.createElement('div');
                friendItem.className = 'friend-item';
                friendItem.innerHTML = `
                    <img src="${friend.avatar}" alt="${friend.name}のアバター" class="friend-avatar">
                    <span class="friend-name">${friend.name}</span>
                `;
                friendListContainer.appendChild(friendItem);

                friendItem.addEventListener('click', () => {
                    const selectedItemId = friendModal.dataset.selectedItemId;
                    const selectedItem = allDummyItems.find(item => item.id === selectedItemId);

                    if (selectedItem) {
                        const now = new Date();
                        const formattedDate = `${now.getFullYear()}/${now.getMonth() + 1}/${now.getDate()}`;

                        // ここで「シェアしたアイテム」として追加
                        const sharedByItem = {
                            ...selectedItem,
                            sharerName: '山田', // 現在のユーザー名
                            sharerAvatar: dummyUsers.find(u => u.isCurrentUser).avatar,
                            recipientName: friend.name,
                            date: formattedDate
                        };
                        sharedByItems.push(sharedByItem);

                        // 成功メッセージ表示など
                        alert(`${friend.name}さんにアイテムをシェアしました！`);
                        friendModal.classList.add('hidden');
                    }
                });
            });

            // 画面切り替えのロジック
            menuItems.forEach(item => {
                item.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetPage = item.dataset.page;

                    // メニュー項目の active クラスを切り替える
                    menuItems.forEach(menu => menu.classList.remove('active'));
                    item.classList.add('active');

                    // ページ表示を切り替える
                    pages.forEach(page => page.classList.remove('active'));
                    document.getElementById(targetPage + '-page').classList.add('active');

                    // 各ページの初期化処理
                    if (targetPage === 'search') {
                        renderItems(allDummyItems, itemGrid);
                    } else if (targetPage === 'timeline') {
                        renderTimeline(dummyPosts);
                    } else if (targetPage === 'favorites') {
                        updateFavorites();
                    } else if (targetPage === 'share-closet') {
                        renderSharedItems(sharedWithItems, sharedWithContainer);
                        renderSharedItems(sharedByItems, sharedByContainer, true);
                    } else if (targetPage === 'try-on') {
                        renderTryOnItems('tops'); // 初期表示はトップス
                    } else if (targetPage === 'event') {
                        renderCalendar(currentMonth, currentYear);
                        const today = new Date();
                        const todayString = `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`;
                        renderEvents(todayString);
                    }
                });
            });

            // プロフィール編集
            editIcon.addEventListener('click', () => {
                usernameInput.readOnly = !usernameInput.readOnly;
                usernameInput.focus();
            });

            // ユーザー切り替え
            userSelector.addEventListener('change', (e) => {
                switchUser(e.target.value);
            });

            // 友だちモーダルを閉じる
            modalCloseBtn.addEventListener('click', () => {
                friendModal.classList.add('hidden');
            });

            // タイムライン投稿
            postButton.addEventListener('click', () => {
                postModal.classList.remove('hidden');
            });

            postModalClose.addEventListener('click', () => {
                postModal.classList.add('hidden');
            });

            submitPostButton.addEventListener('click', () => {
                const caption = postCaptionInput.value;
                const newPost = {
                    user: '山田', // 現在のユーザー名
                    userId: '@yamada',
                    images: ['img/item1.png'], // 新しい投稿用のダミー画像
                    caption: caption,
                    likes: 0,
                    comments: 0
                };
                dummyPosts.unshift(newPost);
                renderTimeline(dummyPosts);
                postModal.classList.add('hidden');
                postCaptionInput.value = '';
                postPreviewContainer.innerHTML = '';
            });

            // シェアクローゼットのタブ切り替え
            shareClosetTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    shareClosetTabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    if (tab.dataset.tab === 'shared-with') {
                        sharedWithContainer.classList.add('active');
                        sharedByContainer.classList.remove('active');
                    } else {
                        sharedWithContainer.classList.remove('active');
                        sharedByContainer.classList.add('active');
                    }
                });
            });

            // 画像拡大モーダルの閉じるボタン
            imageModalClose.addEventListener('click', () => {
                imageModal.classList.add('hidden');
            });

            // 試着機能のタブ切り替え
            tryOnTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    tryOnTabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    renderTryOnItems(tab.dataset.category);
                });
            });

            // イベントカレンダーのナビゲーション
            prevMonthBtn.addEventListener('click', () => {
                currentMonth--;
                if (currentMonth < 0) {
                    currentMonth = 11;
                    currentYear--;
                }
                renderCalendar(currentMonth, currentYear);
            });

            nextMonthBtn.addEventListener('click', () => {
                currentMonth++;
                if (currentMonth > 11) {
                    currentMonth = 0;
                    currentYear++;
                }
                renderCalendar(currentMonth, currentYear);
            });

            // イベント追加モーダル
            addEventButton.addEventListener('click', () => {
                eventDateInput.value = selectedDate.toISOString().split('T')[0];
                eventModal.classList.remove('hidden');
            });

            eventModalClose.addEventListener('click', () => {
                eventModal.classList.add('hidden');
            });

            saveEventButton.addEventListener('click', () => {
                const title = eventTitleInput.value;
                const date = eventDateInput.value;
                const time = eventTimeInput.value;

                if (title && date) {
                    if (!events[date]) {
                        events[date] = [];
                    }
                    events[date].push({ title, time });
                    renderCalendar(currentMonth, currentYear); // カレンダーを更新してドットを表示
                    renderEvents(date); // イベントリストを更新
                    eventModal.classList.add('hidden');
                    eventTitleInput.value = '';
                } else {
                    alert('タイトルと日付を入力してください。');
                }
            });
            
            // 初期化処理
            switchUser('山田');
            renderItems(allDummyItems, itemGrid);
            renderTimeline(dummyPosts);
            renderSharedItems(sharedWithItems, sharedWithContainer);
            renderSharedItems(sharedByItems, sharedByContainer, true);
        });
    </script>
</body>

</html>